# =============================================================================
# HRP Environment Variables
# =============================================================================
# Copy this file to .env and fill in your values:
#   cp .env.example .env
#
# Never commit .env to git!
# For the full variable reference, see this file.
# =============================================================================

# -----------------------------------------------------------------------------
# Core
# -----------------------------------------------------------------------------

# Environment mode: development, staging, production
# In production, startup validation requires ANTHROPIC_API_KEY
HRP_ENVIRONMENT=development

# Data directory (DuckDB, MLflow, logs, backups, etc.)
HRP_DATA_DIR=~/hrp-data

# Database path (default: $HRP_DATA_DIR/hrp.duckdb)
HRP_DB_PATH=~/hrp-data/hrp.duckdb

# Logging level: DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO

# MLflow tracking URI
MLFLOW_TRACKING_URI=sqlite:///~/hrp-data/mlflow/mlflow.db

# -----------------------------------------------------------------------------
# Data Source API Keys
# -----------------------------------------------------------------------------
# Yahoo Finance works without any keys. These are optional for premium sources.

# Polygon.io (real-time WebSocket data, intraday bars)
POLYGON_API_KEY=

# Alpaca (market data)
ALPACA_API_KEY=
ALPACA_SECRET_KEY=

# Tiingo (market data)
TIINGO_API_KEY=

# SimFin (fundamentals; falls back to YFinance if not set)
SIMFIN_API_KEY=

# -----------------------------------------------------------------------------
# Claude API (for agents)
# -----------------------------------------------------------------------------
# Required in production for Signal Scientist, Alpha Researcher, CIO, Reports

ANTHROPIC_API_KEY=

# -----------------------------------------------------------------------------
# Notifications
# -----------------------------------------------------------------------------

# Resend API key for email notifications
RESEND_API_KEY=

# Email address to receive notifications
NOTIFICATION_EMAIL=

# From address for emails (default: onboarding@resend.dev)
NOTIFICATION_FROM_EMAIL=onboarding@resend.dev

# -----------------------------------------------------------------------------
# Dashboard Authentication
# -----------------------------------------------------------------------------
# Required in staging/production environments

# Enable/disable dashboard authentication
HRP_AUTH_ENABLED=true

# Secret key for session cookies (32+ characters, auto-generated by setup.sh)
HRP_AUTH_COOKIE_KEY=your-secret-key-at-least-32-characters-long

# Path to users YAML file
HRP_AUTH_USERS_FILE=~/hrp-data/auth/users.yaml

# Cookie name for auth sessions
HRP_AUTH_COOKIE_NAME=hrp_auth

# Cookie expiry in days
HRP_AUTH_COOKIE_EXPIRY_DAYS=30

# -----------------------------------------------------------------------------
# Ops Server
# -----------------------------------------------------------------------------

# Bind host for ops server (health, metrics endpoints)
HRP_OPS_HOST=0.0.0.0

# Bind port for ops server
HRP_OPS_PORT=8080

# -----------------------------------------------------------------------------
# Interactive Brokers (Tier 4 Trading)
# -----------------------------------------------------------------------------
# See docs/operations/ibkr-setup-guide.md for setup instructions

IBKR_HOST=127.0.0.1
IBKR_PORT=7497
IBKR_CLIENT_ID=1
IBKR_ACCOUNT=DU123456
IBKR_PAPER_TRADING=true

# -----------------------------------------------------------------------------
# Broker Selection
# -----------------------------------------------------------------------------
# Options: ibkr, robinhood, paper

HRP_BROKER_TYPE=ibkr

# -----------------------------------------------------------------------------
# Robinhood (Tier 4 Trading)
# -----------------------------------------------------------------------------
# Required only if HRP_BROKER_TYPE=robinhood

ROBINHOOD_USERNAME=
ROBINHOOD_PASSWORD=
ROBINHOOD_TOTP_SECRET=
ROBINHOOD_ACCOUNT_NUMBER=
ROBINHOOD_PAPER_TRADING=true
ROBINHOOD_PICKLE_NAME=

# -----------------------------------------------------------------------------
# Portfolio & Position Sizing
# -----------------------------------------------------------------------------

# Portfolio value in dollars (for position sizing calculations)
HRP_PORTFOLIO_VALUE=100000

# Maximum number of concurrent positions
HRP_MAX_POSITIONS=20

# Maximum single position as fraction of portfolio (0.10 = 10%)
HRP_MAX_POSITION_PCT=0.10

# Minimum order value in dollars
HRP_MIN_ORDER_VALUE=100

# Dry-run mode: simulate trades without execution (true = safe default)
HRP_TRADING_DRY_RUN=true

# -----------------------------------------------------------------------------
# Risk & VaR
# -----------------------------------------------------------------------------

# Enable VaR-aware position sizing
HRP_USE_VAR_SIZING=true

# Auto stop-loss percentage for new positions (empty = disabled)
HRP_AUTO_STOP_LOSS_PCT=

# Maximum portfolio VaR % (daily, 95% confidence)
HRP_MAX_PORTFOLIO_VAR_PCT=0.02

# Maximum per-position VaR %
HRP_MAX_POSITION_VAR_PCT=0.005

# -----------------------------------------------------------------------------
# Real-Time Ingestion (Tier 5)
# -----------------------------------------------------------------------------
# Requires POLYGON_API_KEY for Polygon.io WebSocket data

# Enable real-time intraday data ingestion
HRP_REALTIME_ENABLED=false

# Comma-separated symbols for real-time ingestion (empty = none)
HRP_REALTIME_SYMBOLS=

# Flush interval in seconds for buffered bars
HRP_REALTIME_FLUSH_INTERVAL=10

# Maximum buffer size before forced flush
HRP_REALTIME_MAX_BUFFER_SIZE=10000

# Maximum reconnection delay in seconds (exponential backoff cap)
HRP_REALTIME_RECONNECT_MAX_DELAY=60

# -----------------------------------------------------------------------------
# Alert Thresholds (all optional â€” have sensible code defaults)
# -----------------------------------------------------------------------------
# Override any threshold via HRP_THRESHOLD_<FIELD_NAME_UPPER>
# See docs/operations/alert-thresholds.md for full reference

# Health score thresholds (0-100)
HRP_THRESHOLD_HEALTH_SCORE_WARNING=90
HRP_THRESHOLD_HEALTH_SCORE_CRITICAL=70

# Data freshness thresholds (days)
HRP_THRESHOLD_FRESHNESS_WARNING_DAYS=3
HRP_THRESHOLD_FRESHNESS_CRITICAL_DAYS=5

# Anomaly count thresholds
HRP_THRESHOLD_ANOMALY_COUNT_WARNING=50
HRP_THRESHOLD_ANOMALY_COUNT_CRITICAL=100

# Model drift thresholds (0.0-1.0)
HRP_THRESHOLD_KL_DIVERGENCE_THRESHOLD=0.2
HRP_THRESHOLD_PSI_THRESHOLD=0.2
HRP_THRESHOLD_IC_DECAY_THRESHOLD=0.2

# Ingestion success rate thresholds (percentage)
HRP_THRESHOLD_INGESTION_SUCCESS_RATE_WARNING=95
HRP_THRESHOLD_INGESTION_SUCCESS_RATE_CRITICAL=80
